
<html>
  <head>
    <title>Уведомление</title>
    {% comment %} <script src="{% static '/channels/js/websocketbridge.js' %}" type="text/javascript"></script> {% endcomment %}
  </head>
  <body>
    <h1>Уведомление Пользователей</h1>
    <p>Notifications</p>
    <ul id="notifylist"></ul>
    <script>
        const webSocketBridge = new WebSocket(
                'ws://'
                + window.location.host
                + '/ws/notification/user/'
        );
        const nl = document.querySelector("#notifylist");
      

        webSocketBridge.onmessage = function(e) { // { type: "user.gossip", event: "New User", username: "Vlad134346" }
            const data = JSON.parse(e.data);
            console.log('data ---> ', data)
            if(data.message_to_room.event == "New User") {
                var el = document.createElement("li");
                el.innerHTML = `Новый пользователь <b>${data.message_to_room.username}</b> был создан!`;
                nl.appendChild(el);
            } else if (data.message_to_room.event === "Success confirm account" && data.message_to_room.username === "{{user.username}}") {
                var el = document.createElement("li");
                el.innerHTML = `<b style="color:#20e01d;">${data.message_to_room.message}</b>`;
                nl.appendChild(el);
            } else if (data.message_to_room.event === "Error confirm account" && data.message_to_room.username === "{{user.username}}") {
                var el = document.createElement("li");
                el.innerHTML = `
                                <b style="color:red;">${data.message_to_room.message}</b>
                `;
                nl.appendChild(el);
            } else if (data.message_to_room.event === "Delete User") {
                var el = document.createElement("li");
                el.innerHTML = `Пользователь <b style="color:red;">${data.message_to_room.username}</b> был удален!`;
                nl.appendChild(el);
            }
        };
    </script>
  </body>
</html>